
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="cQVj-BaADcGVOGB7GOvfbkgJjxni10C2fYWCZ03jOeo" name="google-site-verification" />

    <title>Prompt engineering for LLMs/MLLMs using vision models &#8212; ROS Agents 0.3.3 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=94d292f4"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/prompt_engineering';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Create a spatio-temporal semantic map" href="semantic_map.html" />
    <link rel="prev" title="Create a conversational agent with audio" href="conversational.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.3.3" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ROS_AGENTS_DARK.png" class="logo__image only-light" alt="ROS Agents 0.3.3 documentation - Home"/>
    <img src="../_static/ROS_AGENTS.png" class="logo__image only-dark pst-js-only" alt="ROS Agents 0.3.3 documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://automatikarobotics.com/" title="Automatika" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/automatika-logo.png" class="icon-link-image" alt="Automatika"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/automatika-robotics/ros-agents" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/cAW3BWwt" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">ROS Agents  ü§ñ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation üõ†Ô∏è</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start üöÄ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">Basic Concepts üìö</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Examples ‚ú®</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="conversational.html">Create a conversational agent with audio</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Prompt engineering for LLMs/MLLMs using vision models</a></li>
<li class="toctree-l2"><a class="reference internal" href="semantic_map.html">Create a spatio-temporal semantic map</a></li>
<li class="toctree-l2"><a class="reference internal" href="goto.html">Create a Go-to-X component using map data</a></li>
<li class="toctree-l2"><a class="reference internal" href="tool_calling.html">Use Tool Calling in Go-to-X</a></li>
<li class="toctree-l2"><a class="reference internal" href="semantic_router.html">Create a semantic router to route text queries between different components</a></li>
<li class="toctree-l2"><a class="reference internal" href="complete.html">Bringing it all together ü§ñ</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiprocessing.html">Making the System Robust And Production Ready</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/index.html">API Reference</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/agents/agents.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agents</span></code></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/agents/agents.clients.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agents.clients</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/agents/agents.components.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agents.components</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/agents/agents.vectordbs.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agents.vectordbs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/agents/agents.ros.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agents.ros</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../apidocs/agents/agents.models.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agents.models</span></code></a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/automatika-robotics/ros-agents/blob/main/docs/examples/prompt_engineering.md?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/automatika-robotics/ros-agents/edit/main/docs/examples/prompt_engineering.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/automatika-robotics/ros-agents/issues/new?title=Issue%20on%20page%20%2Fexamples/prompt_engineering.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/prompt_engineering.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Prompt engineering for LLMs/MLLMs using vision models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-object-detection-component">Setting up the Object Detection Component</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-mllm-component">Setting up the MLLM Component</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#launching-the-components">Launching the Components</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="prompt-engineering-for-llms-mllms-using-vision-models">
<h1>Prompt engineering for LLMs/MLLMs using vision models<a class="headerlink" href="#prompt-engineering-for-llms-mllms-using-vision-models" title="Link to this heading">#</a></h1>
<p>In this example we will use the output of an object detection component to enrich the prompt of an MLLM component. Let us start by importing the components.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">agents.components</span> <span class="kn">import</span> <span class="n">Vision</span><span class="p">,</span> <span class="n">MLLM</span>
</pre></div>
</div>
<section id="setting-up-the-object-detection-component">
<h2>Setting up the Object Detection Component<a class="headerlink" href="#setting-up-the-object-detection-component" title="Link to this heading">#</a></h2>
<p>For object detection and tracking, ROS Agents provides a unified Vision component. This component takes as input an image topic published by a camera device onboard our robot. The output of this component can be a <em>detections</em> topic in case of object detection or a <em>trackings</em> topic in case of object tracking. In this example we will use a <em>detections</em> topic.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">agents.ros</span> <span class="kn">import</span> <span class="n">Topic</span>

<span class="c1"># Define the image input topic</span>
<span class="n">image0</span> <span class="o">=</span> <span class="n">Topic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;image_raw&quot;</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;Image&quot;</span><span class="p">)</span>
<span class="c1"># Create a detection topic</span>
<span class="n">detections_topic</span> <span class="o">=</span> <span class="n">Topic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;detections&quot;</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;Detections&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally the component requiers a model client with an object detection model. We will use the RESP client for RoboML and use the VisionModel a convenient model class made available in ROS Agents, for initializing all vision models available in the opensource <a class="reference external" href="https://github.com/open-mmlab/mmdetection">mmdetection</a> library. We will specify the model we want to use by specifying the checkpoint attribute.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Learn about setting up RoboML with vision <a class="reference external" href="https://github.com/automatika-robotics/roboml/blob/main/README.md#for-vision-models-support">here</a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Checkout all available mmdetection models and their benchmarking results in the <a class="reference external" href="https://github.com/open-mmlab/mmdetection?tab=readme-ov-file#overview-of-benchmark-and-model-zoo">mmdetection model zoo</a>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">agents.models</span> <span class="kn">import</span> <span class="n">VisionModel</span>
<span class="kn">from</span> <span class="nn">agents.clients.roboml</span> <span class="kn">import</span> <span class="n">RESPModelClient</span><span class="p">,</span> <span class="n">HTTPModelClient</span>
<span class="kn">from</span> <span class="nn">agents.config</span> <span class="kn">import</span> <span class="n">VisionConfig</span>

<span class="c1"># Add an object detection model</span>
<span class="n">object_detection</span> <span class="o">=</span> <span class="n">VisionModel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;object_detection&quot;</span><span class="p">,</span>
                               <span class="n">checkpoint</span><span class="o">=</span><span class="s2">&quot;dino-4scale_r50_8xb2-12e_coco&quot;</span><span class="p">)</span>
<span class="n">roboml_detection</span> <span class="o">=</span> <span class="n">RESPModelClient</span><span class="p">(</span><span class="n">object_detection</span><span class="p">)</span>

<span class="c1"># Initialize the Vision component</span>
<span class="n">detection_config</span> <span class="o">=</span> <span class="n">VisionConfig</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">vision</span> <span class="o">=</span> <span class="n">Vision</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">image0</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">detections_topic</span><span class="p">],</span>
    <span class="n">trigger</span><span class="o">=</span><span class="n">image0</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">detection_config</span><span class="p">,</span>
    <span class="n">model_client</span><span class="o">=</span><span class="n">roboml_detection</span><span class="p">,</span>
    <span class="n">component_name</span><span class="o">=</span><span class="s2">&quot;detection_component&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Notice that we passed in an option config to the component. Component configs can be used to setup various parameters in the component. If the component calls an ML than inference parameters for the model can be set in the component config.</p>
</div>
</section>
<section id="setting-up-the-mllm-component">
<h2>Setting up the MLLM Component<a class="headerlink" href="#setting-up-the-mllm-component" title="Link to this heading">#</a></h2>
<p>For the MLLM component, we will provide an additional text input topic, which will listen to our queries. The output of the component will be another text topic. We will use the RoboML HTTP client with the multimodal LLM Idefics2 by the good folks at HuggingFace for this example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">agents.models</span> <span class="kn">import</span> <span class="n">Idefics2</span>

<span class="c1"># Define MLLM input and output text topics</span>
<span class="n">text_query</span> <span class="o">=</span> <span class="n">Topic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;text0&quot;</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;String&quot;</span><span class="p">)</span>
<span class="n">text_answer</span> <span class="o">=</span> <span class="n">Topic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;text1&quot;</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;String&quot;</span><span class="p">)</span>

<span class="c1"># Define a model client (working with roboml in this case)</span>
<span class="n">idefics</span> <span class="o">=</span> <span class="n">Idefics2</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;idefics_model&quot;</span><span class="p">)</span>
<span class="n">idefics_client</span> <span class="o">=</span> <span class="n">HTTPModelClient</span><span class="p">(</span><span class="n">idefics</span><span class="p">)</span>

<span class="c1"># Define an MLLM component</span>
<span class="c1"># We can pass in the detections topic which we defined previously directy as an optional input</span>
<span class="c1"># to the MLLM component in addition to its other required inputs</span>
<span class="n">mllm</span> <span class="o">=</span> <span class="n">MLLM</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">text_query</span><span class="p">,</span> <span class="n">image0</span><span class="p">,</span> <span class="n">detections_topic</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">text_answer</span><span class="p">],</span>
    <span class="n">model_client</span><span class="o">=</span><span class="n">idefics_client</span><span class="p">,</span>
    <span class="n">trigger</span><span class="o">=</span><span class="n">text_query</span><span class="p">,</span>
    <span class="n">component_name</span><span class="o">=</span><span class="s2">&quot;mllm_component&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Next we will setup a component level prompt to ensure that our text query and the output of the detections topic are sent to the model as we intend. We will do this by passing a jinja2 template to the <strong>set_component_prompt</strong> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mllm</span><span class="o">.</span><span class="n">set_component_prompt</span><span class="p">(</span>
    <span class="n">template</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Imagine you are a robot.</span>
<span class="s2">    This image has following items: {{ detections }}.</span>
<span class="s2">    Answer the following about this image: {{ text0 }}&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The names of the topics used in the jinja2 template are the same as the name parameters set when creation the Topic objects.</p>
</div>
</section>
<section id="launching-the-components">
<h2>Launching the Components<a class="headerlink" href="#launching-the-components" title="Link to this heading">#</a></h2>
<p>Finally we will launch our components as we did in the previous example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">agents.ros</span> <span class="kn">import</span> <span class="n">Launcher</span>

<span class="c1"># Launch the components</span>
<span class="n">launcher</span> <span class="o">=</span> <span class="n">Launcher</span><span class="p">()</span>
<span class="n">launcher</span><span class="o">.</span><span class="n">add_pkg</span><span class="p">(</span>
    <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="n">vision</span><span class="p">,</span> <span class="n">mllm</span><span class="p">]</span>
    <span class="p">)</span>
<span class="n">launcher</span><span class="o">.</span><span class="n">bringup</span><span class="p">()</span>
</pre></div>
</div>
<p>And there we have it. Complete code of this example is provided below.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Prompt Engineering with Object Detection</span><a class="headerlink" href="#id1" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">agents.components</span> <span class="kn">import</span> <span class="n">Vision</span><span class="p">,</span> <span class="n">MLLM</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">agents.models</span> <span class="kn">import</span> <span class="n">VisionModel</span><span class="p">,</span> <span class="n">Idefics2</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">agents.clients.roboml</span> <span class="kn">import</span> <span class="n">RESPModelClient</span><span class="p">,</span> <span class="n">HTTPModelClient</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">agents.config</span> <span class="kn">import</span> <span class="n">VisionConfig</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">agents.ros</span> <span class="kn">import</span> <span class="n">Topic</span><span class="p">,</span> <span class="n">Launcher</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">image0</span> <span class="o">=</span> <span class="n">Topic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;image_raw&quot;</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;Image&quot;</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="n">detections_topic</span> <span class="o">=</span> <span class="n">Topic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;detections&quot;</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;Detections&quot;</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">object_detection</span> <span class="o">=</span> <span class="n">VisionModel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;object_detection&quot;</span><span class="p">,</span>
<span class="linenos">11</span>                               <span class="n">checkpoint</span><span class="o">=</span><span class="s2">&quot;dino-4scale_r50_8xb2-12e_coco&quot;</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">roboml_detection</span> <span class="o">=</span> <span class="n">RESPModelClient</span><span class="p">(</span><span class="n">object_detection</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">detection_config</span> <span class="o">=</span> <span class="n">VisionConfig</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">vision</span> <span class="o">=</span> <span class="n">Vision</span><span class="p">(</span>
<span class="linenos">16</span>    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">image0</span><span class="p">],</span>
<span class="linenos">17</span>    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">detections_topic</span><span class="p">],</span>
<span class="linenos">18</span>    <span class="n">trigger</span><span class="o">=</span><span class="n">image0</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">config</span><span class="o">=</span><span class="n">detection_config</span><span class="p">,</span>
<span class="linenos">20</span>    <span class="n">model_client</span><span class="o">=</span><span class="n">roboml_detection</span><span class="p">,</span>
<span class="linenos">21</span>    <span class="n">component_name</span><span class="o">=</span><span class="s2">&quot;detection_component&quot;</span><span class="p">,</span>
<span class="linenos">22</span><span class="p">)</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="n">text_query</span> <span class="o">=</span> <span class="n">Topic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;text0&quot;</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;String&quot;</span><span class="p">)</span>
<span class="linenos">25</span><span class="n">text_answer</span> <span class="o">=</span> <span class="n">Topic</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;text1&quot;</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;String&quot;</span><span class="p">)</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="n">idefics</span> <span class="o">=</span> <span class="n">Idefics2</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;idefics_model&quot;</span><span class="p">)</span>
<span class="linenos">28</span><span class="n">idefics_client</span> <span class="o">=</span> <span class="n">HTTPModelClient</span><span class="p">(</span><span class="n">idefics</span><span class="p">)</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="n">mllm</span> <span class="o">=</span> <span class="n">MLLM</span><span class="p">(</span>
<span class="linenos">31</span>    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">text_query</span><span class="p">,</span> <span class="n">image0</span><span class="p">,</span> <span class="n">detections_topic</span><span class="p">],</span>
<span class="linenos">32</span>    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">text_answer</span><span class="p">],</span>
<span class="linenos">33</span>    <span class="n">model_client</span><span class="o">=</span><span class="n">idefics_client</span><span class="p">,</span>
<span class="linenos">34</span>    <span class="n">trigger</span><span class="o">=</span><span class="n">text_query</span><span class="p">,</span>
<span class="linenos">35</span>    <span class="n">component_name</span><span class="o">=</span><span class="s2">&quot;mllm_component&quot;</span>
<span class="linenos">36</span><span class="p">)</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="n">mllm</span><span class="o">.</span><span class="n">set_component_prompt</span><span class="p">(</span>
<span class="linenos">39</span>    <span class="n">template</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Imagine you are a robot.</span>
<span class="linenos">40</span><span class="s2">    This image has following items: {{ detections }}.</span>
<span class="linenos">41</span><span class="s2">    Answer the following about this image: {{ text0 }}&quot;&quot;&quot;</span>
<span class="linenos">42</span><span class="p">)</span>
<span class="linenos">43</span><span class="n">launcher</span> <span class="o">=</span> <span class="n">Launcher</span><span class="p">()</span>
<span class="linenos">44</span><span class="n">launcher</span><span class="o">.</span><span class="n">add_pkg</span><span class="p">(</span>
<span class="linenos">45</span>    <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="n">vision</span><span class="p">,</span> <span class="n">mllm</span><span class="p">]</span>
<span class="linenos">46</span>    <span class="p">)</span>
<span class="linenos">47</span><span class="n">launcher</span><span class="o">.</span><span class="n">bringup</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="conversational.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Create a conversational agent with audio</p>
      </div>
    </a>
    <a class="right-next"
       href="semantic_map.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Create a spatio-temporal semantic map</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-object-detection-component">Setting up the Object Detection Component</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-mllm-component">Setting up the MLLM Component</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#launching-the-components">Launching the Components</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Automatika Robotics
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2025, Automatika Robotics.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>